---
title: "View Audit Events"
slug: "view-audit-events"
position: 1
---

## Overview

Aqua maintains an audit log of several kinds of events: both normal and those indicating security exposures. Reviewing the audit log is often essential for understanding and mitigating security problems in your environment.

## Effects of RBAC

As noted in <a href="/">RBAC effects on each screen (TODO: "SaaS-AM-effects-of-rbac#section-summary-rbac-effects-on-each-screen")</a>, the audit events displayed are filtered by the user's application scope(s); only events relevant to the scope are displayed.

## View audit events in the Aqua UI

In the Aqua UI: Navigate to Security Reports > **Audit** in the main menu. The screen will show a list of security-related events. The number of Audit events is broken down by category (Alert, Block, Detect, and Success) as well as cumulatively (All). For example:

<img src="/img/46f4bac-01_6.5_Audit_events_example.png" alt="01 6.5 Audit events example.png" width="1710px" height="921px" />

## Filtering

#### Filtering criteria

You can filter the list by category, event type, time interval, and one of several other custom filtering criteria (More Filters). See below for more information on categories, types, and filtering.

#### Display and control of currently applied filters

The Audit screen shows all filters that have been applied, like this:

<img src="/img/6b0f2e7-11_6.5_Audit_event_filter_list.png" alt="11 6.5 Audit event filter list.png" width="316px" height="123px" />

The filtering elements include:

- An event category (Alert, Block, Detect, Success or All), which is underlined.
- The other current filtering criteria, which are shown as a series of rounded rectangles; you can remove any of these filtering criteria by clicking the **x** in its box.

In this screenshot, the list has been filtered for events per the filters shown above:

<img src="/img/c3c8456-12_6.5_Audit_event_screen_filtered.png" alt="12 6.5 Audit event screen filtered.png" width="1717px" height="917px" />

#### Additional information

Additional information about each audit event can be viewed by clicking its row; the information will appear in a column on the right side. The information displayed varies according to the <a href="#section-event-types">event type</a>.

In every audit event related to an image (e.g., scanning) the additional information will contain information such as the image name, the SHA-256 hash value of the image, the registry the image resides in (if applicable), and a summary of the security issues found.

The screenshot below shows additional audit information for a container image scan. It includes the function identifier, as well as the two kinds of security issues found in the function (vulnerabilities and sensitive data).

<img src="/img/235ec77-21_6.5_Audit_event_image_info.png" alt="21 6.5 Audit event image info.png" width="1710px" height="909px" />

#### Enforcer-generated audit events

Descriptions for Enforcer-generated audit events include the security control (reason) that triggered the event. For example, this screenshot shows an audit event generated by the system blocking an attempt to execute a non-compliant AWS Lambda serverless function:

<img src="/img/466fba1-31_6.5_Audit_screen_Enforcer.png" alt="31 6.5 Audit screen Enforcer.png" width="1720px" height="643px" />

#### Audit events for Enforcer connection and disconnection

Aqua can generate audit events for the connection and disconnection of Aqua Enforcers, MicroEnforcers, and VM Enforcers. In order to avoid flooding the audit log with disconnection events, you need to explicitly enable this functionality.

1. In the Aqua UI: Go to Settings > **Enforcer**.
2. Select (or de-select) this setting as appropriate, and click **Save**:

<img src="/img/1fe779f-41_6.5_Audit_Enforcer_Connections_and_Disconnections.png" alt="41 6.5 Audit Enforcer Connections and Disconnections.png" width="562px" height="64px" />

:::caution

Selection of this setting might generate a very high number of audit events, especially from MicroEnforcers. This behavior is normal.

:::

#### Command-based audit messages

By default, the details for a command will include the command name without the parameters of the command. To include the full command, enable the **Audit full command arguments** option of the Forensics [control](container-runtime-policy-components#section-list-of-controls) of Container Runtime Policies.

:::info

Enabling full command arguments will expose private command arguments in the audit display.

:::

# Interpret audit events

## Event category

Each audit event is assigned a category, which is used to characterize the event. Each category is indicated by a color:

<table><tr><th>Event category</th><th>Definition</th></tr><tr>
<td><p>Alert (dark red)</p></td>

<td><p>A particularly severe kind of security-related event, such as host disconnection, discovery of new vulnerabilities in an image that is running as a container, and determination of an image as non-compliant. If a related action was attempted, it was blocked by the enforcement of one or more Aqua security policies.</p></td>
</tr><tr>
<td><p>Block (red)</p></td>

<td><p>Other (less severe) security-related events that were blocked by the enforcement of one or more Aqua security policies.</p></td>
</tr><tr>
<td><p>Detect (orange)</p></td>

<td><p>Security-related events that were detected. Although these events violated one or more Aqua security policies, none of these policies were running in Enforce mode.</p></td>
</tr><tr>
<td><p>Success (green)</p></td>

<td><p>Security-related events that did not violate any Aqua security policies. These events are listed only for purposes of auditing.</p></td>
</tr></table>

## Audit types

Each audit event type is also identified with a distinct icon.

<table><tr><th>Audit type</th><th>Description</th></tr><tr>
<td><p>All</p></td>

<td><p>All audit event types. Selecting this option will produce a complete list of audit events.</p></td>
</tr><tr>
<td><p>Administration</p></td>

<td><p>Administrative actions initiated from the Aqua Server (e.g., user authentication)</p></td>
</tr><tr>
<td><p>Alert</p></td>

<td><p>See <a href="#section-event-category">Event category</a> above</p></td>
</tr><tr>
<td><p>Container Engine</p></td>

<td><p>Events related to container engines other than Docker (CRI-O and containerd)</p></td>
</tr><tr>
<td><p>Container Runtime</p></td>

<td><p>Container-initiated actions that are run on the Aqua Enforcer. Event details include the original user name, image name, container name, and the process ID.</p></td>
</tr><tr>
<td><p>CVE</p></td>

<td><p>Events related to vulnerabilities found in images and containers; CVE standards for Common Vulnerabilities and Exposures</p></td>
</tr><tr>
<td><p>Docker</p></td>

<td><p>Events originating from usage of the Docker API or commands, run on the same host as an Aqua Enforcer. Event details include the image name, the container name, rule, and the reason for the event category.</p></td>
</tr><tr>
<td><p>Function Runtime</p></td>

<td><p>Audit events generated as the result of running a serverless function protected by a <a href="/">Function Runtime Policy (TODO: "SaaS-function-runtime-policies")</a></p></td>
</tr><tr>
<td><p>Host Login</p></td>

<td><p>Events generated by failed host login attempts</p></td>
</tr><tr>
<td><p>Host Runtime</p></td>

<td><p>Events generated by the following:
* All Host Runtime Policies
* Successful and/or failed host login attempts, as determined by the Enforcer group <a href="/">Auditing settings (TODO: "SaaS-aqua-enforcer-groups-and-settings#section-auditing")</a></p></td>
</tr><tr>
<td><p>Integrity Monitoring</p></td>

<td><p>Events generated by the File Integrity Monitoring, System Integrity Monitoring, and Windows Registry Monitoring <a href="/">controls (TODO: "SaaS-host-runtime-policy-components#section-controls")</a> of Host Runtime Policies</p></td>
</tr><tr>
<td><p>Malware</p></td>

<td><p>Events generated when malware is detected during scanning of images and hosts</p></td>
</tr><tr>
<td><p>Non-Compliant</p></td>

<td><p>Events related to the following:
* Non-compliant images, and containers running from them
* Non-compliant functions and their run-time execution
* Non-compliant hosts and their run-time activities</p></td>
</tr><tr>
<td><p>Orchestrator</p></td>

<td><p>Events generated at the orchestrator level</p></td>
</tr><tr>
<td><p>Sensitive Data</p></td>

<td><p>Events related to images, functions, and hosts in which sensitive data is detected during scanning</p></td>
</tr></table>

## Custom filtering criteria (More Filters)

You can optionally filter the audit event display by:

- Selecting one of more than 20 attributes, including Container ID, Container Name, Container Runtime Control Name, Enforcer Group, Host Name, Host Runtime Control Name, Image Name, Kubernetes Cluster, MITRE Tactic, Registry Name, and User.
- Entering a text string for further filtering; this will limit the display to all audit events whose selected attribute's name contains the text string.

## Behavioral Detection logs on the Audit screen

The Audit screen displays a complete list of events detected by Behavioral Detection. To see the Behavioral Detection Events in the Audit page:

1. Select the **Detect** tab. This page lists all the behavioral and runtime events that were detected by Behavioral Detection. Refer to <a href="#section-event-category">Event category</a>.
2. To view Behavioral Detection results only, select **Alert** from the Audit Type drop-down menu. Refer to <a href="#section-audit-types">Audit types</a>.
